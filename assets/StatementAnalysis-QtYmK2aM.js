import{_ as Fe,u as ts,r as o,a as es,c as N,A as ss,o as os,b as k,B as as,d as y,e as xe,w as p,M as ns,m as S,l as ut,f as t,g as b,h as _,C as we,t as s,j as m,k as Me,F as G,i as K,n as Se,D as ls,G as ds,E as Ot,H as cs,s as is,v as rs}from"./index-UCJezNKY.js";const us="/assets/Error%20Fall%20Down-Ccs84d5Z.png",e=ot=>(is("data-v-1316af53"),ot=ot(),rs(),ot),_s={class:"p-2"},ms={key:0,class:"flex items-center justify-center h-screen"},hs={key:1,class:"relative flex flex-col items-center justify-center h-screen text-center"},ps=e(()=>t("button",{class:"flex items-center text-black text-lg font-normal"},[t("i",{class:"fas fa-circle-arrow-left mr-2 text-xl",style:{color:"#2563eb"}}),m(" Back ")],-1)),fs=e(()=>t("img",{src:us,alt:"Failed",class:"mx-auto h-48"},null,-1)),vs={class:"mt-4"},ys=e(()=>t("br",null,null,-1)),bs=e(()=>t("a",{href:"mailto:hello@getjupita.com",class:"text-[#1f5aa3]"},"Contact Us..",-1)),gs={key:2,class:"p-2 md:p-8"},xs=e(()=>t("i",{class:"fas fa-circle-arrow-left mr-2 text-xl",style:{color:"#2563eb"}},null,-1)),ws={class:"flex justify-between rounded p-4 bg-white"},Ms=e(()=>t("h2",{class:"text-md font-semibold mt-2 ml-6"},"Analysis result",-1)),Ss={class:"text-right"},Ts=e(()=>t("i",{class:"fas fa-download mr-2"},null,-1)),Os={class:"grid grid-cols-1 md:grid-cols-3 gap-6 text-gray-700 mt-4 mb-6 bg-white rounded p-4"},As=e(()=>t("i",{class:"fas fa-calendar mr-2"},null,-1)),ks=e(()=>t("strong",null,"Statement Period:",-1)),Ys=e(()=>t("br",null,null,-1)),Is={class:"mt-3"},Ds=e(()=>t("i",{class:"fas fa-user-circle mr-2"},null,-1)),Cs=e(()=>t("strong",null,"Account Name:",-1)),Ns=e(()=>t("br",null,null,-1)),Rs=e(()=>t("i",{class:"fas fa-id-card mr-2"},null,-1)),Es=e(()=>t("strong",null,"Account Number:",-1)),$s=e(()=>t("br",null,null,-1)),Ls={class:"mt-6"},Bs={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 px-4 bg-white rounded shdawo-lg p-4"},Vs={class:"bg-blue-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},js={class:"text-md font-semibold"},Ps=e(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Total Credit",-1)),Us={class:"bg-red-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},Ws={class:"text-md font-semibold"},qs=e(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Total Debits",-1)),Hs={class:"bg-green-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},zs={class:"text-md font-semibold"},Gs=e(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Avg. Monthly Credit",-1)),Ks={class:"bg-purple-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},Js={class:"text-md font-semibold"},Zs=e(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Avg. Monthly Debits",-1)),Qs={class:"bg-gray-100 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},Xs={class:"text-md font-semibold"},Fs=e(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Average Monthly Balance",-1)),to={class:"flex flex-col md:flex-row gap-4 mt-4"},eo={class:"bg-white rounded shadow-md p-4 w-full md:w-1/3"},so=e(()=>t("p",{class:"text-sm mb-1"},"Most Frequent Expense",-1)),oo={class:"font-semibold text-gray-800 leading-tight"},ao=e(()=>t("br",null,null,-1)),no={class:"bg-white rounded shadow-md p-4 w-full md:w-1/3"},lo={class:"text-sm mb-1"},co={class:"font-semibold"},io={class:"text-sm mt-1"},ro={class:"font-semibold"},uo={class:"bg-white rounded shadow-md p-4 w-full md:w-1/3"},_o=e(()=>t("p",{class:"text-sm mb-1"},"Most Frequent Expense Amount",-1)),mo={class:"font-semibold"},ho={class:"bg-white p-6 rounded shadow-md overflow-x-auto mt-4"},po=e(()=>t("h2",{class:"text-lg font-semibold m-4"},"Expenses",-1)),fo={class:"min-w-full table-auto border-collapse"},vo=e(()=>t("thead",null,[t("tr",{class:"text-left text-sm font-normal border-b border-gray-200 bg-gray-100"},[t("th",{class:"py-3 px-4"},"Expenses"),t("th",{class:"py-3 px-4"},"Average Monthly Expenditure"),t("th",{class:"py-3 px-4"},"Total Expenditure")])],-1)),yo={class:"py-3 px-4"},bo={class:"py-3 px-4"},go={class:"py-3 px-4"},xo={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},wo={class:"bg-white p-6 rounded shadow-sm"},Mo=e(()=>t("h2",{class:"font-semibold text-md mb-4"},"Income Analysis",-1)),So={class:"grid grid-cols-2 gap-4 text-sm"},To={class:"mb-4"},Oo=e(()=>t("p",null,"Average Predicted Salary",-1)),Ao={class:"font-semibold text-green-600"},ko={class:"mb-4"},Yo=e(()=>t("p",null,"Average Other Income",-1)),Io={class:"font-semibold"},Do={class:"mt-4"},Co=e(()=>t("p",null,"Lowest Salary",-1)),No={class:"font-semibold"},Ro={class:"mt-4"},Eo=e(()=>t("p",null,"Most Recent Salary",-1)),$o={class:"font-semibold"},Lo={class:"bg-white p-6 rounded shadow-sm"},Bo=e(()=>t("h2",{class:"font-semibold text-md mb-4"},"Pay Date Management",-1)),Vo={class:"grid grid-cols-2 gap-4 text-sm"},jo={class:"mb-4"},Po=e(()=>t("p",null,"Expected Salary Payment Day",-1)),Uo={class:"font-semibold text-green-600"},Wo={class:"mb-4"},qo=e(()=>t("p",null,"No. of Salary Payments",-1)),Ho={class:"font-semibold"},zo={class:"mb-4"},Go=e(()=>t("p",null,"Latest Salary Date",-1)),Ko={class:"font-semibold"},Jo={class:"mb-4"},Zo=e(()=>t("p",null,"Lowest Salary Date",-1)),Qo={class:"font-semibold"},Xo={class:"flex flex-col md:flex-row gap-4 text-gray-500 py-10"},Fo={class:"flex-1 bg-white border p-6 rounded shadow"},ta=e(()=>t("h2",{class:"text-lg font-semibold text-black-800 mb-4"},[m(" Inflow Summary "),t("i",{class:"fas fa-arrow-down text-black-600 ml-2"})],-1)),ea={class:"space-y-4"},sa={class:"mt-6"},oa=e(()=>t("p",null,"Total Inflow",-1)),aa={class:"text-green-600 font-bold"},na={class:"flex justify-between mt-6"},la={class:""},da=e(()=>t("p",null,"Average Monthly Inflow",-1)),ca={class:"font-medium"},ia={class:""},ra=e(()=>t("p",null,"Average Weekly Inflow",-1)),ua={class:"font-medium"},_a={class:"flex-1 bg-white border p-6 rounded shadow"},ma=e(()=>t("h2",{class:"text-lg font-semibold text-black-800 mb-4"},[m(" Outflow Summary "),t("i",{class:"fas fa-arrow-up text-black-600 ml-2"})],-1)),ha={class:"space-y-4"},pa={class:"mt-6"},fa=e(()=>t("p",null,"Total Outflow",-1)),va={class:"text-red-600 font-bold"},ya={class:"flex justify-between mt-6"},ba={class:""},ga=e(()=>t("p",null,"Average Monthly Outflow",-1)),xa={class:"font-medium"},wa={class:""},Ma=e(()=>t("p",null,"Average Weekly Outflow",-1)),Sa={class:"font-medium"},Ta={class:"flex gap-4 justify-between p-2"},Oa={class:"flex justify-between bg-[#1f5aa3] text-white rounded p-6 w-full"},Aa={class:"flex-1 text-sm"},ka={class:"text-sm mt-2 font-semibold"},Ya={class:"flex-1 text- text-sm"},Ia={class:"text-sm mt-2 font-semibold"},Da={class:"flex justify-between bg-[#1f5aa3] text-white rounded p-6 w-full"},Ca={class:"flex-1"},Na=e(()=>t("div",{class:"text-sm mt-2"},"Inflow to Outflow Rate",-1)),Ra={class:"text-md font-semibold"},Ea={class:"flex-1"},$a=e(()=>t("div",{class:"text-sm mt-2"},"Overall Inflow to Outflow",-1)),La={class:"text-md font-semibold"},Ba={class:"p-2 rounded shadow-md"},Va={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ja={class:"bg-white p-4 rounded shadow"},Pa=e(()=>t("h3",{class:"text-lg font-bold mb-6"},"Monthly Credit & Debit",-1)),Ua={class:"overflow-y-auto max-h-96"},Wa={class:"min-w-full table-auto text-sm text-left text-gray-600"},qa=e(()=>t("thead",{class:"bg-gray-100 font-medium bg-gray-100"},[t("tr",null,[t("th",{class:"px-2 py-2"},"Month"),t("th",{class:"px-2 py-2"},"Total Credit"),t("th",{class:"px-2 py-2"},"Total Debit")])],-1)),Ha={class:"px-2 py-2"},za={class:"px-2 py-2"},Ga={class:"px-2 py-2"},Ka={class:"font-semibold text-gray-800 bg-gray-50 border-t"},Ja=e(()=>t("td",{class:"px-2 py-2"},"Total",-1)),Za={class:"px-2 text-green-800 py-2"},Qa={class:"px-2 text-red-800 py-2"},Xa={class:"bg-white p-4 rounded-lg shadow"},Fa=e(()=>t("h3",{class:"text-lg font-bold mb-6"},"Weekly Credit & Debit",-1)),tn={class:"overflow-y-auto max-h-96"},en={class:"min-w-full table-auto text-sm text-left text-gray-600"},sn=e(()=>t("thead",{class:"bg-gray-100 font-medium"},[t("tr",null,[t("th",{class:"px-2 py-2"},"Week"),t("th",{class:"px-2 py-2"},"Total Credit"),t("th",{class:"px-2 py-2"},"Total Debit")])],-1)),on={class:"px-2 py-2"},an={class:"px-2 py-2"},nn={class:"px-2 py-2"},ln={class:"font-semibold text-gray-800 bg-gray-50 border-t"},dn=e(()=>t("td",{class:"px-2 py-2"},"Total",-1)),cn={class:"px-2 text-green-800 py-2"},rn={class:"px-2 text-red-800 py-2"},un={class:""},_n={class:"bg-white p-6 rounded shadow-md mb-6"},mn=e(()=>t("h2",{class:"text-lg font-semibold mb-6 flex items-center gap-2"},[m(" Loan Analysis "),t("i",{class:"fas fa-info-circle text-blue-700 text-base"})],-1)),hn={class:"grid grid-cols-1 md:grid-cols-4 gap-6 text-sm"},pn=e(()=>t("p",{class:"text-gray-600"},"Number of Loan Transactions",-1)),fn={class:"font-bold text-black"},vn=e(()=>t("p",{class:"text-gray-600"},"Total Loan Amount",-1)),yn={class:"text-red-600 font-bold"},bn=e(()=>t("p",{class:"text-gray-600"},"Average Monthly Loan Amount",-1)),gn={class:"text-blue-700 font-bold"},xn=e(()=>t("p",{class:"text-gray-600"},"Total Loan Repayment Amount",-1)),wn={class:"text-green-600 font-bold"},Mn=e(()=>t("p",{class:"text-gray-600"},"Avg. Monthly Loan Repayment Amt",-1)),Sn={class:"text-black font-bold"},Tn=e(()=>t("p",{class:"text-gray-600"},"Loan to Inflow Rate",-1)),On={class:"text-black font-bold"},An=e(()=>t("p",{class:"text-gray-600"},"Latest Loan Transaction Date",-1)),kn={class:"text-black font-bold"},Yn=e(()=>t("p",{class:"text-gray-600"},"Latest Loan Repayment Transaction Date",-1)),In={class:"text-black font-bold"},Dn={class:"bg-[#1f5aa3] p-6 rounded shadow-md mb-6"},Cn=e(()=>t("h2",{class:"text-lg font-semibold text-white mb-6 flex items-center gap-2"},[m(" Patterns "),t("i",{class:"fas fa-chart-line text-white text-xs"})],-1)),Nn={class:"grid grid-cols-1 md:grid-cols-4 gap-6 text-sm text-white"},Rn=e(()=>t("p",null,"Account Sweep",-1)),En=e(()=>t("p",null,"Number of Betting Transactions",-1)),$n={class:"font-bold"},Ln=e(()=>t("p",null,"Gambling Rate",-1)),Bn={class:"font-bold"},Vn=e(()=>t("p",null,"Transactions between 500k - 1M",-1)),jn={class:"font-bold"},Pn=e(()=>t("p",null,"Percentage of Credit Transactions",-1)),Un={class:"font-bold"},Wn=e(()=>t("p",null,"Percentage of Debit Transactions",-1)),qn={class:"font-bold"},Hn=e(()=>t("p",null,"Most Frequent",-1)),zn={class:"font-bold"},Gn=e(()=>t("p",null,"Transactions Greater than 1M",-1)),Kn={class:"font-bold"},Jn={class:"bg-white p-6 rounded-lg shadow text-sm text-gray-800"},Zn=e(()=>t("h2",{class:"text-base font-semibold mb-4"},"Self Transfer Summary",-1)),Qn={class:"grid grid-cols-3 gap-4 mb-6"},Xn=e(()=>t("div",null,"Number of Self Transfer (Inflow)",-1)),Fn={class:"font-bold mt-1"},tl=e(()=>t("div",null,"Value of Self Transfer (Inflow)",-1)),el={class:"text-green-600 font-bold mt-1"},sl=e(()=>t("div",null,"Total Number of Transactions",-1)),ol={class:"font-bold mt-1"},al=e(()=>t("div",null,"Number of Self Transfer (Outflow)",-1)),nl={class:"font-bold mt-1"},ll=e(()=>t("div",null,"Value of Self Transfer (Outflow)",-1)),dl={class:"text-red-600 font-bold mt-1"},cl=e(()=>t("div",null,"Returned Cheque",-1)),il={class:"font-bold mt-1"},rl={class:"flex flex-col md:flex-row gap-6 justify-between mt-4"},ul={class:"w-full md:w-1/2"},_l={class:"bg-white rounded border shadow p-4 max-h-96 overflow-y-auto"},ml=e(()=>t("h3",{class:"font-semibold text-sm md:text-base mb-4"}," Self Transfer Transactions ",-1)),hl={class:"w-full text-sm text-left"},pl=e(()=>t("thead",{class:"font-semibold bg-gray-100"},[t("tr",null,[t("th",{class:"py-2 px-4"},"Month"),t("th",{class:"py-2 px-4"},"Inflow"),t("th",{class:"py-2 px-4"},"Outflow")])],-1)),fl={key:0},vl=e(()=>t("td",{colspan:"3",class:"text-center py-4 text-gray-500"}," No data available ",-1)),yl=[vl],bl={class:"py-2 px-4"},gl={class:"py-2 px-4"},xl={class:"py-2 px-4"},wl={class:"w-full md:w-1/2"},Ml={class:"bg-white border rounded shadow p-4 max-h-96 overflow-y-auto"},Sl=e(()=>t("h3",{class:"font-semibold text-sm md:text-base mb-4"}," Account Balance Analysis ",-1)),Tl={class:"w-full text-sm text-left"},Ol=e(()=>t("thead",{class:"font-semibold bg-gray-100"},[t("tr",null,[t("th",{class:"py-2 px-4"},"Month"),t("th",{class:"py-2 px-4"},"Highest Balance"),t("th",{class:"py-2 px-4"},"Lowest Balance")])],-1)),Al={class:"py-2 px-4"},kl={class:"py-2 px-4"},Yl={class:"py-2 px-4"},Il={class:"py-4"},Dl=e(()=>t("span",{class:"text-md font-semibold mt-6 ml-2"},"Transaction History",-1)),Cl={class:"flex items-center justify-between p-2"},Nl={class:"flex items-center space-x-4 pt-2"},Rl=e(()=>t("i",{class:"fa-solid fa-filter"},null,-1)),El=e(()=>t("i",{class:"fas fa-search text-[#1f5aa3]"},null,-1)),$l={class:"flex m-2 gap-4"},Ll={class:"relative min-h-[200px]"},Bl=e(()=>t("thead",{class:"font-semibold bg-gray-100"},[t("tr",null,[t("th",{class:"px-2 py-3 font-semibold"},"S/N"),t("th",{class:"px-2 py-3 font-semibold"},"Date"),t("th",{class:"px-2 py-3 font-semibold"},"Description"),t("th",{class:"px-2 py-3 font-semibold"},"Type"),t("th",{class:"px-2 py-3 font-semibold"},"Amount"),t("th",{class:"px-2 py-3 font-semibold"},"Balance")])],-1)),Vl={class:"px-2 py-4"},jl={class:"px-2 py-4"},Pl={class:"px-2 py-4"},Ul={class:"px-6 py-4 font-semibold"},Wl={class:"px-2 py-4"},ql={class:"px-2 py-4"},Hl=e(()=>t("span",null,"1–12 of 12",-1)),zl={class:"flex items-center space-x-2"},Gl=e(()=>t("span",null,"Rows per page:",-1)),Kl={__name:"StatementAnalysis",setup(ot){const J=ts();J.params.id;const _t=J.params.status;console.log("statement status:",_t);const at=o("Summary"),P=o(null),U=o(null),mt=r=>r?S(r).format("MMMM Do YYYY"):"N/A";function i(r){return new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN",minimumFractionDigits:2}).format(r||0)}const At=o(15),D=es(),Te=o(null),nt=o(!0),kt=o(null),ht=o(""),Oe=o(""),pt=o(""),ft=o(""),Yt=o(""),It=o(0),Dt=o(0),vt=o(0),yt=o(0),bt=o(0),Ct=o(0),gt=o(0),Ae=o(0),Nt=o(0),Z=o(0),ke=o(0),Rt=o(0),lt=o([]),dt=o([]),Ye=N(()=>lt.value.reduce((r,l)=>r+l.credit,0)),Ie=N(()=>lt.value.reduce((r,l)=>r+l.debit,0)),De=N(()=>dt.value.reduce((r,l)=>r+l.credit,0)),Ce=N(()=>dt.value.reduce((r,l)=>r+l.debit,0)),Et=o(0),$t=o(0),Lt=o(0),Bt=o(""),Q=o([]),Vt=o(""),jt=o(""),Pt=o(""),Ut=o(""),Wt=o(0),xt=o(""),qt=o(0),Ht=o(""),Ne=o(0),Re=o(0),zt=o(0),Gt=o(0),Kt=o(0),Jt=o(0),Zt=o(0),Ee=o(0),$e=o(0),Qt=o(""),Xt=o([]),Ft=o(""),te=o(""),Le=o(0),ee=o(""),se=o(0),oe=o(0),ae=o(0),ne=o(0),le=o(0),de=o(0),ce=o(0),ie=o(0),ct=o([]),re=o([]),wt=o([]),Mt=o([]),L=o({}),ue=o(null);o(null);const Be=async r=>{var x,Y,T,R,V,E,w,O,C,q,X,H,d,M,_e,me,he,pe,fe,ve;const l=localStorage.getItem("data")?JSON.parse(localStorage.getItem("data")):null;console.log(l);const B=l?l==null?void 0:l.token:(x=N(()=>D.token))==null?void 0:x.value,f=`https://dev02201.getjupita.com/api/${l?(Y=l.user)!=null&&Y.business_name?(T=l.user)==null?void 0:T.id:(R=l.user)==null?void 0:R.tenant_id:(V=N(()=>{var j;return(j=D.user)!=null&&j.business_name?D.user.id:D.user.tenant_id}))==null?void 0:V.value}/get-analysis-result?analysis_id=${r}`;nt.value=!0;try{let j=function(a){return S(a,"M-YYYY").format("MMM YYYY")};const z=await ut.get(f,{headers:{Authorization:`Bearer ${B}`,"Content-Type":"application/json"}});console.log("statement analysis result page data:",z),Te.value=z.data;const u=(O=(w=(E=z.data)==null?void 0:E.data)==null?void 0:w.analysis_result)==null?void 0:O.analysis_result;ht.value=u.failedReason,console.log("failed reason:",ht.value),Oe.value=(u==null?void 0:u.name)||"N/A",pt.value=(u==null?void 0:u.clientFullName)||"N/A",Yt.value=(u==null?void 0:u.accountId)||"N/A",ue.value=(X=(q=(C=z.data)==null?void 0:C.data)==null?void 0:q.analysis_result)==null?void 0:X.analysis_result.statementType;const v=(u==null?void 0:u.behavioralAnalysis)||{};console.log("behavioural:",v),L.value=(u==null?void 0:u.incomeAnalysis)||{},console.log("income:",L.value),xt.value=v.accountSweep||"No",qt.value=v.gamblingRate||0,Ht.value=v.gamblingStatus||"N/A",Ne.value=v.loanInflowRate||0,Re.value=v.accountActivity||0,zt.value=v.totalLoanAmount||0,Gt.value=v.loanToInflowRate||0,Kt.value=v.numberLoanTransactions||0,Jt.value=v.averageMonthlyLoanAmount||0,Zt.value=v.totalLoanRepaymentAmount||0,Ee.value=v.loanRepaymentToInflowRate||0,$e.value=v.numberRepaymentTransactions||0,Xt.value=v.latestRepaymentTransaction||[];const rt=Xt.value[0]||null;Ft.value=rt!=null&&rt.date?S(rt.date).format("MMM D, YYYY"):"N/A";const ye=(H=v.latestLoanTransaction)==null?void 0:H[0];Qt.value=ye?S(ye.date).format("MMMM D, YYYY"):"N/A",te.value=v.overallInflowToOutflowRate||"N/A",Le.value=v.percentOfInflowIrregularity||0,ee.value=v.monthToMonthInflowToOutflowRate||"N/A",se.value=v.averageMonthlyLoanRepaymentAmount||0;const n=u==null?void 0:u.cashFlowAnalysis;console.log("cash flow data:",n),Et.value=u==null?void 0:u.spendAnalysis.mostFrequentExpense,$t.value=u==null?void 0:u.spendAnalysis.mostFrequentExpenseAmount;const c=((me=(_e=(M=(d=z.data)==null?void 0:d.data)==null?void 0:M.analysis_result)==null?void 0:_e.analysis_result)==null?void 0:me.spendAnalysis)||{},A=((ve=(fe=(pe=(he=z.data)==null?void 0:he.data)==null?void 0:pe.analysis_result)==null?void 0:fe.analysis_result)==null?void 0:ve.transactionPatternAnalysis)||{};console.log("pattern analysis:",A),Vt.value=(A.percentDebitTransactions*100).toFixed(2)+"%",jt.value=(A.percentCreditTransactions*100).toFixed(2)+"%",Pt.value=(A.percentOfTransactionsBetween500ThousandToOneMillionNaira*100).toFixed(2)+"%",Ut.value=(A.percentOfTransactionsGreaterThanOneMillionNaira*100).toFixed(2)+"%",Wt.value=A.mostFrequentBalanceRange,oe.value=A.noOfSelfTransferInflows,ae.value=A.noOfSelfTransferOutflows,ne.value=A.selfTransferInflowAmount,le.value=A.selfTransferOutflowAmount,ce.value=A.totalNumberOfTransactions,ie.value=A.returnCheque;const We=A.selfTransferInflowTransactionsByMonth||[],qe=A.selfTransferOutflowTransactionsByMonth||[],F=new Map;We.forEach(a=>{const h=j(a.date);F.set(h,{month:h,inflow:a.amount,outflow:0})}),qe.forEach(a=>{const h=j(a.date);F.has(h)?F.get(h).outflow=a.amount:F.set(h,{month:h,inflow:0,outflow:a.amount})}),ct.value=Array.from(F.values()).sort((a,h)=>S(a.month,"MMM YYYY")-S(h.month,"MMM YYYY")),Lt.value=c.highestSpend,Bt.value=S(c.monthWithHighestSpend,"M/YYYY").format("MMMM YYYY"),Q.value=[{label:"Rent",monthly:c.averageMonthlySpendOnRent??0,total:c.totalSpendOnRent??0},{label:"Hospitality and Food",monthly:c.averageMonthlySpendOnHospitalityAndFood??0,total:c.totalSpendOnHospitalityAndFood??0},{label:"Transportation",monthly:c.averageMonthlySpendOnTransportation??0,total:c.totalSpendOnTransportation??0},{label:"Utilities",monthly:c.averageMonthlySpendOnUtilities??0,total:c.totalSpendOnUtilities??0},{label:"Charges and Stamp Duty",monthly:c.averageMonthlySpendOnChargesAndStampDuty??0,total:c.totalSpendOnChargesAndStampDuty??0},{label:"Transfer",monthly:c.averageMonthlySpendOnTransfer??0,total:c.totalSpendOnTransfer??0},{label:"ATM Withdrawals and POS",monthly:c.averageMonthlySpendOnAtmAndPOS??0,total:c.totalSpendOnAtmAndPOS??0},{label:"Airtime and Data",monthly:c.averageMonthlySpendOnAirtimeAndData??0,total:c.totalSpendOnAirtimeAndData??0},{label:"Crypto",monthly:c.averageMonthlySpendOnCrypto??0,total:c.totalSpendOnCrypto??0},{label:"Entertainment",monthly:c.averageMonthlySpendOnEntertainment??0,total:c.totalSpendOnEntertainment??0},{label:"Health",monthly:c.averageMonthlySpendOnHealth??0,total:c.totalSpendOnHealth??0},{label:"Gambling",monthly:c.averageMonthlySpendOnGambling??0,total:c.totalSpendOnGambling??0},{label:"Insurance",monthly:c.averageMonthlySpendOnInsurance??0,total:c.totalSpendOnInsurance??0},{label:"International Transactions",monthly:c.averageMonthlySpendOnInternationalTransactions??0,total:c.totalSpendOnInternationalTransactions??0},{label:"Online and Web",monthly:c.averageMonthlySpendOnOnlineAndWeb??0,total:c.totalSpendOnOnlineAndWeb??0},{label:"Savings and Investments",monthly:c.averageMonthlySpendOnSavingsAndInvestments??0,total:c.totalSpendOnSavingsAndInvestments??0},{label:"Travel",monthly:c.averageMonthlySpendOnTravel??0,total:c.totalSpendOnTravel??0},{label:"USSD",monthly:c.averageMonthlySpendOnUSSD??0,total:c.totalSpendOnUSSD??0},{label:"Transfer Via Agents",monthly:c.averageMonthlyTransactionsViaAgents??0,total:c.totalTransactionsViaAgents??0},{label:"Others",monthly:c.averageMonthlySpendOnOthers??0,total:c.totalSpendOnOthers??0},{label:"Total Expenses",monthly:c.averageMonthlyTotalExpenses??0,total:c.totalExpenses??0}];const He=Q.value.find(a=>a.label==="Total Expenses");let ze=Q.value.filter(a=>a.label!=="Total Expenses").sort((a,h)=>h.monthly!==a.monthly?h.monthly-a.monthly:h.total-a.total);Q.value=[...ze,He],It.value=(n==null?void 0:n.totalDebitTurnOver)||0,Dt.value=(n==null?void 0:n.totalCreditTurnover)||0,vt.value=(n==null?void 0:n.averageMonthlyDebits)||0,yt.value=(n==null?void 0:n.averageMonthlyCredits)||0,bt.value=(n==null?void 0:n.averageMonthlyBalance)||0,Ct.value=(n==null?void 0:n.averageWeeklyBalance)||0,gt.value=(n==null?void 0:n.totalCreditTurnover)||0,Ae.value=(n==null?void 0:n.averageMonthlyCredits)||0,Nt.value=(n==null?void 0:n.averageWeeklyCredits)||0,Z.value=(n==null?void 0:n.totalDebitTurnOver)||0,ke.value=(n==null?void 0:n.averageMonthlyDebits)||0,Rt.value=(n==null?void 0:n.averageWeeklyDebits)||0;const Ge=(n==null?void 0:n.monthlyHighestBalance)||[],Ke=(n==null?void 0:n.monthlyLowestBalance)||[];de.value=Z.value!==0?+((gt.value-Z.value)/Z.value).toFixed(2):0;const tt=new Map;Ge.forEach(a=>{const h=`${a.month_name} ${a.year}`,I=S(h,"MMMM YYYY").format("MMM YYYY"),$=`${a.month_name}-${a.year}`;tt.set($,{month:I,highest:a.highest_balance,lowest:0})}),Ke.forEach(a=>{const h=`${a.month_name} ${a.year}`,I=S(h,"MMMM YYYY").format("MMM YYYY"),$=`${a.month_name}-${a.year}`;tt.has($)?tt.get($).lowest=a.lowest_balance:tt.set($,{month:I,highest:0,lowest:a.lowest_balance})}),re.value=Array.from(tt.values());const Je=(n==null?void 0:n.monthlyInflow)||[],Ze=(n==null?void 0:n.monthlyOutflow)||[],et=new Map;Je.forEach(a=>{const h=`${a.month_name} ${a.year}`,I=S(h,"MMMM YYYY").format("MMM YYYY"),$=`${a.month_name}-${a.year}`;et.set($,{month:I,credit:a.amount,debit:0})}),Ze.forEach(a=>{const h=`${a.month_name} ${a.year}`,I=S(h,"MMMM YYYY").format("MMM YYYY"),$=`${a.month_name}-${a.year}`;et.has($)?et.get($).debit=a.amount:et.set($,{month:I,credit:0,debit:a.amount})}),lt.value=Array.from(et.values());const Qe=(n==null?void 0:n.weeklyInflow)||[],Xe=(n==null?void 0:n.weeklyOutflow)||[],st=new Map;Qe.forEach(a=>{const h=S().month(a.month_name).format("MMM"),I=`${a.year}-${h}-W${a.week}`;st.set(I,{week:`${h} ${a.year} | ${a.week}`,credit:a.amount,debit:0})}),Xe.forEach(a=>{const h=S().month(a.month_name).format("MMM"),I=`${a.year}-${h}-W${a.week}`;st.has(I)?st.get(I).debit=a.amount:st.set(I,{week:`${h} ${a.year} ${a.week}`,credit:0,debit:a.amount})}),dt.value=Array.from(st.values());const be=new Date(u==null?void 0:u.startDate),ge=new Date(u==null?void 0:u.endDate);!isNaN(be)&&!isNaN(ge)?ft.value=`${S(be).format("MMMM D, YYYY")} - ${S(ge).format("MMMM D, YYYY")}`:ft.value="Unknown period"}catch(j){console.error("Error fetching analysis result:",j),kt.value="Unable to fetch analysis result."}finally{nt.value=!1}};N(()=>{const r=de.value;return r>0?"Positive cash flow":r<0?"Negative cash flow":"neutral"});const Ve=N(()=>ue.value==="CONSUMER"),je=async r=>{var Y,T,R,V,E;const l=localStorage.getItem("data")?JSON.parse(localStorage.getItem("data")):null;console.log(l);const B=l?l==null?void 0:l.token:(Y=N(()=>D.token))==null?void 0:Y.value,g=l?(T=l.user)!=null&&T.business_name?(R=l.user)==null?void 0:R.id:(V=l.user)==null?void 0:V.tenant_id:(E=N(()=>{var w;return(w=D.user)!=null&&w.business_name?D.user.id:D.user.tenant_id}))==null?void 0:E.value,f=J.params.id,x=`https://dev02201.getjupita.com
/api/${g}/get-statement-transactions?analysis_id=${f}`;try{const w=await ut.get(x,{headers:{Authorization:`Bearer ${B}`}});console.log("fetch transactions response:",w),Mt.value=w.data.data.transactions,wt.value=[...Mt.value]}catch(w){console.error(w)}},it=o(""),W=o(null),St=o(!1),Tt=async()=>{var B;St.value=!0,await ds();let r=Mt.value;const l=(B=it.value)==null?void 0:B.toLowerCase().trim();if(l&&(r=r.filter(g=>Object.values(g).some(f=>f==null?void 0:f.toString().toLowerCase().includes(l)))),W.value&&W.value!=="all"&&(r=r.filter(g=>{var f;return((f=g.type)==null?void 0:f.toLowerCase())===W.value.toLowerCase()})),P.value&&U.value){const g=new Date(P.value).getTime(),f=new Date(U.value).getTime();r=r.filter(x=>{const Y=new Date(x.date).getTime();return Y>=g&&Y<=f})}wt.value=r,await new Promise(g=>setTimeout(g,300)),St.value=!1},Pe=()=>{P.value=null,U.value=null,Tt()};ss([it,W],Tt),os(()=>{const r=J.params.id;r?(Be(r),je()):(kt.value="Invalid analysis ID.",nt.value=!1)});const Ue=async()=>{var x,Y,T,R,V,E,w;const r=localStorage.getItem("data")?JSON.parse(localStorage.getItem("data")):null;console.log(r);const l=r?r==null?void 0:r.token:(x=N(()=>D.token))==null?void 0:x.value,B=r?(Y=r.user)!=null&&Y.business_name?(T=r.user)==null?void 0:T.id:(R=r.user)==null?void 0:R.tenant_id:(V=N(()=>{var O;return(O=D.user)!=null&&O.business_name?D.user.id:D.user.tenant_id}))==null?void 0:V.value,g=J.params.id,f=`https://dev02201.getjupita.com
/api/${B}/download-insight-report?analysis_id=${g}`;try{Ot({title:"Downloading",message:"Getting your analysis report...",type:"info",duration:3e3});const O=await ut.get(f,{headers:{Authorization:`Bearer ${l}`}}),C=(w=(E=O==null?void 0:O.data)==null?void 0:E.data)==null?void 0:w.download;if(!(C!=null&&C.document_url)||!(C!=null&&C.document_name))throw new Error("No download information or document URL found in the response.");const q=C.document_url,H=`${pt.value.replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"")||"analysis_report"}.pdf`,d=await ut.get(q,{responseType:"blob"});cs.saveAs(d.data,H),Ot({title:"Success",message:"Analysis report downloaded successfully.",type:"success",duration:6e3})}catch(O){console.error("Download failed:",O),Ot({title:"Error",message:"Failed to download analysis. Please try again.",type:"error",duration:6e3})}};return(r,l)=>{const B=k("v-progress-circular"),g=k("RouterLink"),f=k("v-btn"),x=k("v-tab"),Y=k("v-tabs"),T=k("v-tabs-window-item"),R=k("v-select"),V=k("v-text-field"),E=k("el-date-picker"),w=k("v-table"),O=k("v-icon"),C=k("v-card-actions"),q=k("v-card"),X=k("v-tabs-window"),H=as("loading");return y(),xe(ns,null,{default:p(()=>[t("div",_s,[nt.value?(y(),b("div",ms,[_(B,{size:100,width:10,color:"primary",indeterminate:""})])):we(_t)==="FAILED"||we(_t)==="ALTERED"?(y(),b("div",hs,[_(g,{to:"/dashboard",class:"absolute top-4 left-4"},{default:p(()=>[ps]),_:1}),fs,t("p",vs,[t("strong",null,s(ht.value),1),m(),ys,m(" If you have any further questions, please don't hesitate to "),bs])])):(y(),b("div",gs,[_(g,{to:"/dashboard"},{default:p(()=>[t("button",{onClick:l[0]||(l[0]=(...d)=>r.goBack&&r.goBack(...d)),class:"mb-4 flex items-center text-black text-lg font-normal"},[xs,m(" Back ")])]),_:1}),t("div",ws,[Ms,t("div",Ss,[_(f,{onClick:Ue,"no-uppercase":"",size:"small",class:"normal-case p-4 bg-blue-600 hover:bg-blue-700 text-white text-none mr-2 custom-btn"},{default:p(()=>[Ts,m(" Export PDF ")]),_:1})])]),t("div",Os,[t("p",null,[As,ks,m(),Ys,t("span",Is,s(ft.value),1)]),t("p",null,[Ds,Cs,m(),Ns,m(" "+s(pt.value),1)]),t("p",null,[Rs,Es,m(),$s,m(" "+s(Yt.value),1)])]),t("div",Ls,[_(Y,{modelValue:at.value,"onUpdate:modelValue":l[1]||(l[1]=d=>at.value=d),"align-tabs":"start",class:"custom-tabs mb-4",color:"primary",grow:""},{default:p(()=>[_(x,{value:"summary"},{default:p(()=>[m("Summary")]),_:1}),Ve.value?(y(),xe(x,{key:0,value:"income"},{default:p(()=>[m("Income")]),_:1})):Me("",!0),_(x,{value:"cash flow"},{default:p(()=>[m("Cash Flow")]),_:1}),_(x,{value:"behavioral"},{default:p(()=>[m("Behavioral")]),_:1}),_(x,{value:"transactions"},{default:p(()=>[m("Transactions")]),_:1})]),_:1},8,["modelValue"]),_(X,{modelValue:at.value,"onUpdate:modelValue":l[7]||(l[7]=d=>at.value=d)},{default:p(()=>[_(T,{value:"summary"},{default:p(()=>[t("div",Bs,[t("div",Vs,[t("div",js,s(i(Dt.value)),1),Ps]),t("div",Us,[t("div",Ws,s(i(It.value)),1),qs]),t("div",Hs,[t("div",zs,s(i(yt.value)),1),Gs]),t("div",Ks,[t("div",Js,s(i(vt.value)),1),Zs]),t("div",Qs,[t("div",Xs,s(i(bt.value)),1),Fs])]),t("div",to,[t("div",eo,[so,t("p",oo,[m(s(Et.value),1),ao])]),t("div",no,[t("p",lo,[m(" Highest Spend: "),t("span",co,s(i(Lt.value)),1)]),t("p",io,[m(" Transaction Date: "),t("span",ro,s(Bt.value),1)])]),t("div",uo,[_o,t("p",mo,s(i($t.value)),1)])]),t("div",ho,[po,t("table",fo,[vo,t("tbody",null,[(y(!0),b(G,null,K(Q.value,(d,M)=>(y(),b("tr",{key:M,class:"text-sm text-gray-700 border-b border-gray-100 hover:bg-gray-50"},[t("td",yo,s(d.label),1),t("td",bo,s(i(d.monthly)),1),t("td",go,s(i(d.total)),1)]))),128))])])])]),_:1}),_(T,{value:"income"},{default:p(()=>[t("div",xo,[t("div",wo,[Mo,t("div",So,[t("div",To,[Oo,t("p",Ao,s(i(L.value.averagePredictedSalary)),1)]),t("div",ko,[Yo,t("p",Io,s(i(L.value.averageOtherIncome)),1)]),t("div",Do,[Co,t("p",No,s(i(L.value.lowestSalary)),1)]),t("div",Ro,[Eo,t("p",$o,s(i(L.value.mostRecentSalary)),1)])])]),t("div",Lo,[Bo,t("div",Vo,[t("div",jo,[Po,t("p",Uo,s(L.value.expectedSalaryPaymentDay||0),1)]),t("div",Wo,[qo,t("p",Ho,s(L.value.numberOfSalaryPayments||0),1)]),t("div",zo,[Go,t("p",Ko,s(mt(L.value.lastDateOfSalaryPayment)),1)]),t("div",Jo,[Zo,t("p",Qo,s(mt(L.value.lowestSalaryDate)),1)])])])])]),_:1}),_(T,{value:"cash flow"},{default:p(()=>[t("div",Xo,[t("div",Fo,[ta,t("div",ea,[t("div",sa,[oa,t("span",aa,s(i(gt.value)),1)]),t("div",na,[t("div",la,[da,t("span",ca,s(i(yt.value)),1)]),t("div",ia,[ra,t("span",ua,s(i(Nt.value)),1)])])])]),t("div",_a,[ma,t("div",ha,[t("div",pa,[fa,t("span",va,s(i(Z.value)),1)]),t("div",ya,[t("div",ba,[ga,t("span",xa,s(i(vt.value)),1)]),t("div",wa,[Ma,t("span",Sa,s(i(Rt.value)),1)])])])])]),t("div",Ta,[t("div",Oa,[t("div",Aa,[m(" Average Monthly Balance "),t("div",ka,s(i(bt.value)),1)]),t("div",Ya,[m(" Average Weekly Balance "),t("div",Ia,s(i(Ct.value)),1)])]),t("div",Da,[t("div",Ca,[Na,t("div",Ra,s(ee.value),1)]),t("div",Ea,[$a,t("div",La,s(te.value),1)])])]),t("div",Ba,[t("div",Va,[t("div",ja,[Pa,t("div",Ua,[t("table",Wa,[qa,t("tbody",null,[(y(!0),b(G,null,K(lt.value,(d,M)=>(y(),b("tr",{key:M,class:"border-b"},[t("td",Ha,s(d.month),1),t("td",za,s(i(d.credit)),1),t("td",Ga,s(i(d.debit)),1)]))),128))]),t("tfoot",Ka,[t("tr",null,[Ja,t("td",Za,s(i(Ye.value)),1),t("td",Qa,s(i(Ie.value)),1)])])])])]),t("div",Xa,[Fa,t("div",tn,[t("table",en,[sn,t("tbody",null,[(y(!0),b(G,null,K(dt.value,(d,M)=>(y(),b("tr",{key:M,class:"border-b"},[t("td",on,s(d.week),1),t("td",an,s(i(d.credit)),1),t("td",nn,s(i(d.debit)),1)]))),128))]),t("tfoot",ln,[t("tr",null,[dn,t("td",cn,s(i(De.value)),1),t("td",rn,s(i(Ce.value)),1)])])])])])])])]),_:1}),_(T,{value:"behavioral"},{default:p(()=>[t("div",un,[t("div",_n,[mn,t("div",hn,[t("div",null,[pn,t("p",fn,s(Kt.value),1)]),t("div",null,[vn,t("p",yn,s(i(zt.value)),1)]),t("div",null,[bn,t("p",gn,s(i(Jt.value)),1)]),t("div",null,[xn,t("p",wn,s(i(Zt.value)),1)]),t("div",null,[Mn,t("p",Sn,s(i(se.value)),1)]),t("div",null,[Tn,t("p",On,s(i(Gt.value)),1)]),t("div",null,[An,t("p",kn,s(Qt.value),1)]),t("div",null,[Yn,t("p",In,s(Ft.value),1)])])]),t("div",Dn,[Cn,t("div",Nn,[t("div",null,[Rn,t("p",{class:Se(xt.value==="YES"?"font-bold text-white":"text-gray-300")},s(xt.value),3)]),t("div",null,[En,t("p",$n,s(Ht.value),1)]),t("div",null,[Ln,t("p",Bn,s(qt.value),1)]),t("div",null,[Vn,t("p",jn,s(Pt.value),1)]),t("div",null,[Pn,t("p",Un,s(jt.value),1)]),t("div",null,[Wn,t("p",qn,s(Vt.value),1)]),t("div",null,[Hn,t("p",zn,s(Wt.value),1)]),t("div",null,[Gn,t("p",Kn,s(Ut.value),1)])])])]),t("div",Jn,[Zn,t("div",Qn,[t("div",null,[Xn,t("div",Fn,s(oe.value),1)]),t("div",null,[tl,t("div",el,s(i(ne.value)),1)]),t("div",null,[sl,t("div",ol,s(ce.value),1)]),t("div",null,[al,t("div",nl,s(ae.value),1)]),t("div",null,[ll,t("div",dl,s(i(le.value)),1)]),t("div",null,[cl,t("div",il,s(i(ie.value)),1)])])]),t("div",rl,[t("div",ul,[t("div",_l,[ml,t("table",hl,[pl,t("tbody",null,[!ct.value||ct.value.length===0?(y(),b("tr",fl,yl)):Me("",!0),(y(!0),b(G,null,K(ct.value,(d,M)=>(y(),b("tr",{key:M,class:"border-b last:border-none"},[t("td",bl,s(d.month),1),t("td",gl,s(i(d.inflow)),1),t("td",xl,s(i(d.outflow)),1)]))),128))])])])]),t("div",wl,[t("div",Ml,[Sl,t("table",Tl,[Ol,t("tbody",null,[(y(!0),b(G,null,K(re.value,(d,M)=>(y(),b("tr",{key:M},[t("td",Al,s(d.month),1),t("td",kl,s(i(d.highest)),1),t("td",Yl,s(i(d.lowest)),1)]))),128))])])])])])]),_:1}),_(T,{value:"transactions"},{default:p(()=>[t("div",Il,[_(q,{class:"rounded-lg shadow-md pa-4"},{default:p(()=>[Dl,t("div",Cl,[t("div",Nl,[Rl,_(R,{modelValue:W.value,"onUpdate:modelValue":l[2]||(l[2]=d=>W.value=d),items:["all","credit","debit"],color:"[#1f5aa3]",label:"Status",density:"compact","hide-details":"",variant:"outlined",class:"w-32"},null,8,["modelValue"])]),_(V,{modelValue:it.value,"onUpdate:modelValue":l[3]||(l[3]=d=>it.value=d),rounded:"",placeholder:"Search for a transaction",density:"compact","hide-details":"",variant:"outlined",class:"max-w-xs rounded-md",label:"Search",color:"[#1f5aa3]","append-inner-icon":""},{"append-inner":p(()=>[El]),_:1},8,["modelValue"])]),_(E,{modelValue:P.value,"onUpdate:modelValue":l[4]||(l[4]=d=>P.value=d),type:"date",placeholder:"Start date",class:"w-20 m-2",size:"small"},null,8,["modelValue"]),_(E,{modelValue:U.value,"onUpdate:modelValue":l[5]||(l[5]=d=>U.value=d),type:"date",placeholder:"End date",class:"w-20 m-2",size:"small"},null,8,["modelValue"]),t("div",$l,[_(f,{size:"small",color:"primary",variant:"flat",onClick:Tt},{default:p(()=>[m(" Apply ")]),_:1}),_(f,{size:"small",color:"error",variant:"outlined",onClick:Pe,disabled:!P.value&&!U.value},{default:p(()=>[m(" Clear ")]),_:1},8,["disabled"])]),ls((y(),b("div",Ll,[_(w,{class:"min-w-full text-sm pa-2"},{default:p(()=>[Bl,t("tbody",null,[(y(!0),b(G,null,K(wt.value,(d,M)=>(y(),b("tr",{key:M,class:"border-t border-gray-200 hover:bg-gray-50 transition-colors"},[t("td",Vl,s(M+1),1),t("td",jl,s(mt(d.date)),1),t("td",Pl,s(d.description),1),t("td",Ul,[t("span",{class:Se(d.type==="CREDIT"?"text-green-600 py-1 px-2 text-xs font-semibold rounded-full bg-green-100":"text-red-600 py-1 px-2 text-xs font-semibold rounded-full bg-red-100")},s(d.type),3)]),t("td",Wl,s(i(d.amount)),1),t("td",ql,s(i(d.balance)),1)]))),128))])]),_:1})])),[[H,St.value]]),_(C,{class:"justify-between px-6 py-4 text-sm text-gray-500"},{default:p(()=>[Hl,t("div",zl,[Gl,_(R,{items:[15,30,45],modelValue:At.value,"onUpdate:modelValue":l[6]||(l[6]=d=>At.value=d),density:"compact","hide-details":"",class:"w-20",variant:"outlined"},null,8,["modelValue"]),_(f,{icon:"",density:"comfortable"},{default:p(()=>[_(O,null,{default:p(()=>[m("mdi-chevron-left")]),_:1})]),_:1}),_(f,{icon:"",density:"comfortable"},{default:p(()=>[_(O,null,{default:p(()=>[m("mdi-chevron-right")]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1})]),_:1},8,["modelValue"])])]))])]),_:1})}}},Zl=Fe(Kl,[["__scopeId","data-v-1316af53"]]);export{Zl as default};
